{% extends "base/base.html" %}
{% load markdownify %}
{% block content %}

<div class="container">
  {% include 'blog/includes/search.html' %}
  <div class="search-result">
    <div class="width">
      {% if count > 1 and query %}
          <h3>Search parameter '<i>{{query}}</i>' returned <b>{{count}}</b> blogs</h3>
      {% elif count == 1 and query %}
        <h3>Your search '<i>{{query}}</i>' returned <b>{{count}}</b> blog</h3>
      {% elif query and count == 0 %}
        <h3>'<i>{{query}}</i>' was not found, try a different term or <b><a href="/">Return to blogs</a></b></h3>
      {% endif %}
    </div>

    <div class="width">
      {% if count > 1 and tag %}
          <h3><b>{{count}}</b> blogs tagged as '<i>{{tag}}</i>'</h3>
      {% elif count == 1 and tag %}
        <h3><b>{{count}}</b> blog tagged as '<i>{{tag}}</i>'</h3>
      {% endif %}
    </div>
  </div>

  {% comment %} <div class="width">
    {% if tag == None or query == None and count > 1 %}
    <h2>
      Page <b>{{ page_obj.number }}</b> of <b>{{ page_obj.paginator.num_pages }}</b>. Total blogs, <b>{{count}}</b>
    </h2>
    {% endif %}
  </div> {% endcomment %}

  {% for post in page_obj %}
  <article class="width">
    <div data-id="{{post.id}}" class="blog">
      <a href="/{{post.slug}}">
        <h2>{{ post.title }}</h2>
      </a>
      <div class="date-author-tag">
        <div class="date-author">
          <div class="date">Posted {{ post.date_created | timesince  }} ago By</div>
          <div class="author">
            <a href="/kibui" class="author">{{post.author}}</a>
          </div>
        </div>
        <div class="tags-layout">
          <p>Tags: </p>
          <div class="tags">
            {% for tag in post.tags.all %}
            <a href="{% url "blog-list-tag" tag.slug %}">
              <div class="tag {{ tag }}">{{ tag }}</div>
            </a>
            {% if not forloop.last %} {% endif %} 
            {% endfor %}
          </div>
        </div>
      </div>
      <p>{{ post.content | markdownify | truncatechars:120 }}</p>
    </div>
  </article>
  {% endfor %}</div>
{% endblock content %}